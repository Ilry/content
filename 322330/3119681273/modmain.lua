GLOBAL.setmetatable(env,{__index=function(nHlJ,lw4Q7kbl)return GLOBAL.rawget(GLOBAL,lw4Q7kbl)end})Assets={Asset("ANIM","anim/status_xiumian.zip")}local Ch=GetModConfigData("key1")or KEY_R;local urkh=GetModConfigData("key2")or KEY_Z;local zhzpBSx=GetModConfigData("key3")or KEY_X;local rHSjalVy=GetModConfigData("key4")or KEY_C;local TjhsnP=GetModConfigData("huifu")or 0;local function t5jzEd9(IN)if IN.components.xiumian~=nil then return IN.components.xiumian:GetPercent()elseif IN.player_classified~=nil and IN.player_classified._old_xiumianpercent~=nil then return IN.player_classified._old_xiumianpercent else return 0 end end;local JZAU2=require("prefabs/farm_plant_defs").PLANT_DEFS;local zPXTTg={}local JZAU2=require("prefabs/farm_plant_defs").PLANT_DEFS;local function seMLr(QYf1,RfsnisO) if RfsnisO~=nil and RfsnisO.food~=nil and RfsnisO.food.components.edible then QYf1.components.eater.healthabsorption=1;local lvW2ga=RfsnisO.food.components.edible:GetHealth(QYf1)QYf1.components.eater.healthabsorption=0;if lvW2ga>0 then QYf1.components.xiumian:DoDelta(lvW2ga)end;if JZAU2[RfsnisO.food.prefab]and JZAU2[RfsnisO.food.prefab].seed then for T7RKP=1,2 do local _L6Bs=SpawnPrefab(JZAU2[RfsnisO.food.prefab].seed)if _L6Bs then QYf1.components.inventory:GiveItem(_L6Bs,nil,QYf1:GetPosition())end end end end end;local qX={sword_lunarplant=true,armor_bramble=true,armor_lunarplant=true,lunarplanthat=true,staff_lunarplant=true}local function h_8(SH)if IsEntityDeadOrGhost(SH,true)then return end;local wU4wYbA9=SH.components.bloomness:GetLevel()if wU4wYbA9 >=3 and TjhsnP>0 then SH.components.health:DoDelta(TjhsnP,true)end;local fFeQcIM=SH.components.inventory for JEHSHPh3,bb in pairs(fFeQcIM.equipslots)do if bb and qX[bb.prefab]then if bb.components.finiteuses and bb.components.finiteuses:GetPercent()<1 then local o5e6fP=bb.components.finiteuses.total*0.02;bb.components.finiteuses:SetUses(math.min(bb.components.finiteuses.current+o5e6fP,bb.components.finiteuses.total))elseif bb.components.armor and bb.components.armor:GetPercent()<1 then bb.components.armor:Repair(0.02*bb.components.armor.maxcondition)elseif bb.components.fueled and bb.components.fueled:GetPercent()<1 then bb.components.fueled:SetPercent(bb.components.fueled:GetPercent()+0.02)end end end end;TUNING.ARMORBRAMBLE=TUNING.ARMORBRAMBLE*2;local function xL7OTb(iq7ol,eMV,WDTNkTD)if iq7ol.components.health~=nil then local Oejsws=iq7ol.components.health:GetPercent()iq7ol.components.health.maxhealth=iq7ol.components.health.maxhealth+eMV.health;if not WDTNkTD then iq7ol.components.health:SetPercent(Oejsws)local CkD73N0=(eMV.health>0 and 0.01)or-0.01;iq7ol.components.health:DoDelta(CkD73N0,false,nil,true)end end end;local function w8T3f(PlwhaRKJ,Caz4NM4Z)if PlwhaRKJ.inst.components.combat then PlwhaRKJ.inst.components.combat.externaldamagemultipliers:SetModifier("升级喵",1+Caz4NM4Z*0.1)end end;local K=Class(function(XVxxx,hD)XVxxx.inst=hD;XVxxx.level=0;XVxxx.maxlevel=1000 end,nil,{level=w8T3f})function K:OnSave()return{level=self.level}end;function K:OnLoad(G5BuU5)if G5BuU5 and G5BuU5.level~=nil and self.level~=G5BuU5.level then self.level=G5BuU5.level;xL7OTb(self.inst,{health=self.level*50},true)end end;AddPrefabPostInit("wormwood",function(AfwsY) AfwsY.Getxiumian=t5jzEd9;if not TheWorld.ismastersim then return AfwsY end;AfwsY:ListenForEvent("oneat",seMLr)AfwsY:AddComponent("xiumian")AfwsY.components.xiumian:SetMax(500)AfwsY.kaihuahuixuetask=AfwsY:DoPeriodicTask(2,h_8)AfwsY.components.wwlevel=K(AfwsY)local T=AfwsY.OnPreLoad;AfwsY.OnPreLoad=function(AfwsY,ITdz)if ITdz and ITdz._xxx_health then AfwsY.components.health:SetCurrentHealth(ITdz._xxx_health)end;if T then T(AfwsY,ITdz)end end;local WZs=AfwsY.OnSave;AfwsY.OnSave=function(AfwsY,AjfoUo)AjfoUo._xxx_health=AfwsY.components.health.currenthealth;if WZs then WZs(AfwsY,AjfoUo)end end end)AddPrefabPostInit("greengem",function(Er9zidsB)if not TheWorld.ismastersim then return Er9zidsB end;Er9zidsB:AddComponent("wormwood_eat")end) AddPrefabPostInit("opalpreciousgem",function(X)if not TheWorld.ismastersim then return X end;X:AddComponent("wormwood_eat")end)local function qL(dR)if dR and dR.prefab=="wormwood"and dR.components.bloomness then return dR.components.bloomness:GetLevel()>=3 end;return false end;AddComponentPostInit("childspawner",function(JFXtQwy)local uMV17h0=JFXtQwy.ReleaseAllChildren;function JFXtQwy:ReleaseAllChildren(E2NZK,...)if qL(E2NZK)then return end;return uMV17h0(JFXtQwy,E2NZK,...)end end) AddComponentPostInit("combat",function(WNWWe)local zMzjn3lk=WNWWe.SetRetargetFunction;function WNWWe:SetRetargetFunction(...)zMzjn3lk(WNWWe,...)if WNWWe.targetfn~=nil then local GGv=WNWWe.targetfn;WNWWe.targetfn=function(...)local ZIzh4Si,c8D4n81=GGv(...)if ZIzh4Si then if qL(ZIzh4Si)then ZIzh4Si=nil end end;return ZIzh4Si,c8D4n81 end end end;local Trkkpmd=WNWWe.ShareTarget;function WNWWe:ShareTarget(cSjJHx,...)if WNWWe.inst and qL(cSjJHx)then return end;Trkkpmd(WNWWe,cSjJHx,...)end;local L=WNWWe.SuggestTarget;function WNWWe:SuggestTarget(fa,...)if WNWWe.inst and qL(fa)then return end;L(WNWWe,fa,...)end end)local vfIyB=Action({priority=1,mount_valid=true,encumbered_valid=true})vfIyB.id="WORMWOOD_EAT"vfIyB.str=STRINGS.ACTIONS.EAT;vfIyB.fn=function(M)local dIZlrvD=M.invobject or M.target;if dIZlrvD then if dIZlrvD.components.stackable then dIZlrvD.components.stackable:Get():Remove()else dIZlrvD:Remove()end;if M.doer and M.doer.components.wwlevel and M.doer.components.wwlevel.level<M.doer.components.wwlevel.maxlevel then M.doer.components.wwlevel.level=M.doer.components.wwlevel.level+1;xL7OTb(M.doer,{health=50})end;return true end end;AddAction(vfIyB)AddComponentAction("INVENTORY","wormwood_eat",function(jQgsATKd,aBbGg,D9)if aBbGg and aBbGg.prefab=="wormwood"then table.insert(D9,ACTIONS.WORMWOOD_EAT)end end)AddStategraphActionHandler("wilson",ActionHandler(ACTIONS.WORMWOOD_EAT,"eat"))AddStategraphActionHandler("wilson_client",ActionHandler(ACTIONS.WORMWOOD_EAT,"eat"))local quNsijN="chongmu_skill"local function QUh2tc(G,gE)if IsEntityDeadOrGhost(G,true)then return false end;if G.components.playercontroller and not G.components.playercontroller:IsEnabled()then return false end;if G.sg and G.sg:HasStateTag("busy")then return false end;if not gE and G.components.rider~=nil and G.components.rider:IsRiding()then return false end;return true end;local qboV={"FX","DECOR","INLIMBO"}local function nSBOx7(QgC,CYoa)if QgC~=CYoa and(TheNet:GetPVPEnabled()or not QgC:HasTag("player"))and not(QgC.components.freezable~=nil and QgC.components.freezable:IsFrozen())and not(QgC.components.pinnable~=nil and QgC.components.pinnable:IsStuck())and not(QgC.components.fossilizable~=nil and QgC.components.fossilizable:IsFossilized())then local K3ipRr=QgC.components.rider~=nil and QgC.components.rider:GetMount()or nil;if K3ipRr~=nil then K3ipRr:PushEvent("ridersleep",{sleepiness=10,sleeptime=TUNING.PANFLUTE_SLEEPTIME})end if QgC.components.farmplanttendable~=nil then QgC.components.farmplanttendable:TendTo(CYoa)elseif QgC.components.sleeper~=nil then QgC.components.sleeper:AddSleepiness(10,TUNING.PANFLUTE_SLEEPTIME)elseif QgC.components.grogginess~=nil then QgC.components.grogginess:AddGrogginess(10,TUNING.PANFLUTE_SLEEPTIME)else QgC:PushEvent("knockedout")end end end;local function u(F2tY)local rb21L2,o_v255,wUVm=F2tY.Transform:GetWorldPosition()local VQ=TheSim:FindEntities(rb21L2,o_v255,wUVm,TUNING.PANFLUTE_SLEEPRANGE,nil,qboV)for oTYNsnP,I in ipairs(VQ)do if I~=F2tY then nSBOx7(I,F2tY)end end end;local function Ki1(L,mR5gwW)local DfbW=L:GetPosition()local mR5gwW=SpawnPrefab(mR5gwW or"stafflight")mR5gwW.Transform:SetPosition(DfbW:Get())end;local zz1QI={[Ch]=function(sh)if QUh2tc(sh)then sh.sg:GoToState("虫木_休眠")end end,[urkh]=function(rrFLbCtj)if QUh2tc(rrFLbCtj)and rrFLbCtj.components.xiumian and rrFLbCtj.components.xiumian.current>=50 then u(rrFLbCtj)rrFLbCtj.components.xiumian:DoDelta(-50)rrFLbCtj.sg:GoToState("wormxxspell",function(rrFLbCtj)end)end end,[zhzpBSx]=function(YcPea0vg)if QUh2tc(YcPea0vg)and YcPea0vg.components.xiumian and YcPea0vg.components.xiumian.current>=100 then YcPea0vg.sg:GoToState("wormxxspell",function(YcPea0vg)Ki1(YcPea0vg,"staffcoldlight")YcPea0vg.components.xiumian:DoDelta( -100)end)end end,[rHSjalVy]=function(usLpLoaH)if QUh2tc(usLpLoaH)and usLpLoaH.components.xiumian and usLpLoaH.components.xiumian.current>=100 then usLpLoaH.sg:GoToState("wormxxspell",function(usLpLoaH)Ki1(usLpLoaH)usLpLoaH.components.xiumian:DoDelta(-100)end)end end}AddModRPCHandler(quNsijN.."_button",quNsijN.."_button",function(e7dv,inx0)if inx0 and zz1QI[inx0]then zz1QI[inx0](e7dv)end end)local function kFTAh()if TheNet:IsServerPaused()then return false end;local A5k5yt=TheFrontEnd:GetActiveScreen()if A5k5yt then if A5k5yt:IsEditing()then return false elseif type(A5k5yt.name)=="string"and A5k5yt.name=="HUD"then return true end end;return false end;local function LBf(B7SHDx7h)if B7SHDx7h.owner and B7SHDx7h.owner.prefab=="wormwood"then B7SHDx7h[quNsijN.."_handlers"]={}B7SHDx7h.inst:ListenForEvent("onremove",function()for EEpoeR,_k in pairs(B7SHDx7h[quNsijN.."_handlers"])do _k:Remove()end end)for Ef,KfM in pairs(zz1QI)do B7SHDx7h[quNsijN.."_handlers"][Ef.."down"]=TheInput:AddKeyDownHandler(Ef,function()if not kFTAh()then return end;SendModRPCToServer(MOD_RPC[quNsijN.."_button"][quNsijN.."_button"],Ef)end)end end end;AddClassPostConstruct("widgets/controls",LBf) local function dijn4Ph(Vd)if Vd.talksoundoverride~=nil then Vd.SoundEmitter:PlaySound(Vd.talksoundoverride,"talk")return true elseif not Vd:HasTag("mime")then Vd.SoundEmitter:PlaySound((Vd.talker_path_override or"dontstarve/characters/").. (Vd.soundsname or Vd.prefab).."/talk_LP","talk")return true end end;local function CO1(Oynw,QBO)if not QBO and Oynw.endtalksound~=nil and Oynw.SoundEmitter:PlayingSound("talk")then Oynw.SoundEmitter:PlaySound(Oynw.endtalksound)end;Oynw.SoundEmitter:KillSound("talk")end;local function RlZo(s4ggux,hrVI4meU)if s4ggux.sg.statemem.talktask~=nil then s4ggux.sg.statemem.talktask:Cancel()s4ggux.sg.statemem.talktask=nil;CO1(s4ggux,hrVI4meU)end end;local function SUn(xEq6TAF)RlZo(xEq6TAF,true)if dijn4Ph(xEq6TAF)then xEq6TAF.sg.statemem.talktask=xEq6TAF:DoTaskInTime(1.5+math.random()*.5,RlZo)end;return true end;local function Ib4(UIjls)RlZo(UIjls)return true end;local function fjV1G2(jdLnB0vD,PSlD)return(jdLnB0vD:HasTag("wereplayer")and"item_in")or(PSlD.eslot~=EQUIPSLOTS.HANDS and"item_hat")or(not PSlD.slip and"item_in")or(PSlD.item~=nil and PSlD.item:IsValid()and"tool_slip")or"toolbroke",PSlD.item end;local Do={"_combat"}local _={"INLIMBO"}local function TqYJ4(nN)nN.diuchouhentask=nil;if nN~=nil and nN.sg:HasStateTag("hiding")then local J,A,g3Qeqnr=nN.Transform:GetWorldPosition()local qHpY64=TheSim:FindEntities(J,A,g3Qeqnr,20,Do,_)for z,qccJ5b in ipairs(qHpY64)do if qccJ5b.components.combat~=nil and qccJ5b.components.combat.target==nN then qccJ5b.components.combat:SetTarget(nil)end end end end;local function DI(ARuba)if ARuba.components.temperature~=nil then if ARuba.components.temperature:GetCurrent()<TUNING.SLEEP_TARGET_TEMP_TENT then ARuba.components.temperature:SetTemperature(ARuba.components.temperature:GetCurrent()+TUNING.SLEEP_TEMP_PER_TICK)end end end;local function b(Wo53nZ)local XRfQ=false;local gFPRdEC=Wo53nZ.components.sleepingbaguser;if not gFPRdEC then return end;local lw9gLt3=TUNING.SLEEP_HUNGER_PER_TICK*gFPRdEC.hunger_bonus_mult;local T=TUNING.SLEEP_HEALTH_PER_TICK*2*gFPRdEC.health_bonus_mult;local I5=TUNING.SLEEP_SANITY_PER_TICK*gFPRdEC.sanity_bonus_mult* (XRfQ and TUNING.GOODSLEEP_SANITY or 1)local JmE=false;if gFPRdEC.inst.components.hunger~=nil then gFPRdEC.inst.components.hunger:DoDelta(lw9gLt3,true,true)JmE=gFPRdEC.inst.components.hunger:IsStarving()end;if gFPRdEC.inst.components.sanity~=nil and gFPRdEC.inst.components.sanity:GetPercentWithPenalty()<1 then gFPRdEC.inst.components.sanity:DoDelta(I5,true)end;if not JmE and gFPRdEC.inst.components.health~=nil then local s4=2+gFPRdEC.inst.components.health.maxhealth*0.01;gFPRdEC.inst.components.health:DoDelta(s4,true,"xiumain",true)end;DI(gFPRdEC.inst)if JmE then end end;AddComponentPostInit("moisture",function(FFG)local a31jEAS=FFG.GetSleepingBagDryingRate;function FFG:GetSleepingBagDryingRate(...)if FFG.xiumian_dryingrate then return math.max(0,FFG.xiumian_dryingrate)end;return a31jEAS(FFG,...)end end) AddStategraphState('wilson',State{name="虫木_休眠",tags={"hiding","notalking","nomorph","busy","nopredict","nodangle"},onenter=function(LS4h)LS4h.components.locomotor:Stop()LS4h.AnimState:OverrideSymbol("swap_hat","hat_bush","swap_hat")LS4h.AnimState:ClearOverrideSymbol("headbase_hat")LS4h.AnimState:Show("HAT")LS4h.AnimState:Show("HAIR_HAT")LS4h.AnimState:Hide("HAIR_NOHAT")LS4h.AnimState:Hide("HAIR")if LS4h:HasTag("player")then LS4h.AnimState:Hide("HEAD")LS4h.AnimState:Show("HEAD_HAT")LS4h.AnimState:Show("HEAD_HAT_NOHELM")LS4h.AnimState:Hide("HEAD_HAT_HELM")end;LS4h.AnimState:ShowSymbol("face")LS4h.AnimState:ShowSymbol("swap_face") LS4h.AnimState:ShowSymbol("beard")LS4h.AnimState:ShowSymbol("cheeks")LS4h.AnimState:UseHeadHatExchange(false)local eux092_P=LS4h.components.inventory:GetEquippedItem(EQUIPSLOTS.HEAD)if eux092_P and eux092_P.fx and eux092_P.fx.AttachToOwner then eux092_P.fx:Remove()eux092_P.fx=nil end;LS4h.AnimState:PlayAnimation("hide")LS4h.AnimState:PushAnimation("hide_idle",false)LS4h.SoundEmitter:PlaySound("dontstarve/movement/foley/hidebush")if LS4h.diuchouhentask~=nil then LS4h.diuchouhentask:Cancel()end;LS4h.diuchouhentask=LS4h:DoTaskInTime(5,TqYJ4)end,timeline={TimeEvent(24*FRAMES,function(ZA9)ZA9.sg:RemoveStateTag("busy")ZA9.sg:RemoveStateTag("nopredict")ZA9.sg:AddStateTag("idle")if ZA9.xiumiantask~=nil then ZA9.xiumiantask:Cancel()end;ZA9.xiumiantask=ZA9:DoPeriodicTask(TUNING.SLEEP_TICK_PERIOD,b)if ZA9.components.moisture then ZA9.components.moisture.xiumian_dryingrate=math.max(0,-TUNING.SLEEP_WETNESS_PER_TICK/TUNING.SLEEP_TICK_PERIOD)end end)},onupdate=function(hWgmxm) end,events={EventHandler("ontalk",function(UBg54E)UBg54E.AnimState:PushAnimation("hide_idle",false)return SUn(UBg54E)end),EventHandler("donetalking",Ib4),EventHandler("unequip",function(gQGq,OyHc5FEv)if not gQGq.sg:HasStateTag("idle")then gQGq.sg:GoToState(fjV1G2(gQGq,OyHc5FEv))end end)},onexit=function(Dn1Xi)if Dn1Xi.components.moisture then Dn1Xi.components.moisture.xiumian_dryingrate=nil end;if Dn1Xi.xiumiantask~=nil then Dn1Xi.xiumiantask:Cancel()Dn1Xi.xiumiantask=nil end;if Dn1Xi.diuchouhentask~=nil then Dn1Xi.diuchouhentask:Cancel()Dn1Xi.diuchouhentask=nil end;Dn1Xi.AnimState:ClearOverrideSymbol("headbase_hat")Dn1Xi.AnimState:ClearOverrideSymbol("swap_hat")Dn1Xi.AnimState:Hide("HAT")Dn1Xi.AnimState:Hide("HAIR_HAT")Dn1Xi.AnimState:Show("HAIR_NOHAT")Dn1Xi.AnimState:Show("HAIR")if Dn1Xi:HasTag("player")then Dn1Xi.AnimState:Show("HEAD")Dn1Xi.AnimState:Hide("HEAD_HAT")Dn1Xi.AnimState:Hide("HEAD_HAT_NOHELM")Dn1Xi.AnimState:Hide("HEAD_HAT_HELM")end;if Dn1Xi.sg.statemem.talktask~=nil then Dn1Xi.sg.statemem.talktask:Cancel()Dn1Xi.sg.statemem.talktask=nil;CO1(Dn1Xi)end;if not IsEntityDeadOrGhost(Dn1Xi,true)then local _gGmBBE=Dn1Xi.components.inventory:Unequip(EQUIPSLOTS.HEAD) if _gGmBBE~=nil and Dn1Xi.components.inventory then Dn1Xi:DoTaskInTime(0,function()Dn1Xi.components.inventory:Equip(_gGmBBE)end)end end end}) AddStategraphState('wilson',State{name="wormxxspell",tags={"doing","busy","canrotate"},onenter=function(rIX4,AI14eFhp)if rIX4.components.playercontroller~=nil then rIX4.components.playercontroller:Enable(false)end;rIX4.AnimState:PlayAnimation("cointoss_pre")rIX4.AnimState:PushAnimation("cointoss",false)rIX4.components.locomotor:Stop()rIX4.sg.statemem.spellfn=AI14eFhp;local iW2O=nil;rIX4.sg.statemem.fxcolour=iW2O~=nil and iW2O.fxcolour or{1,1,1}rIX4.sg.statemem.castsound=iW2O~=nil and iW2O.castsound end,timeline={TimeEvent(7*FRAMES,function(Gdp)Gdp.sg.statemem.stafffx=SpawnPrefab((Gdp.components.rider~=nil and Gdp.components.rider:IsRiding())and"cointosscastfx_mount"or"cointosscastfx")Gdp.sg.statemem.stafffx.entity:SetParent(Gdp.entity)Gdp.sg.statemem.stafffx:SetUp(Gdp.sg.statemem.fxcolour)end),TimeEvent(15*FRAMES,function(nbqmx)nbqmx.sg.statemem.stafflight=SpawnPrefab("staff_castinglight")nbqmx.sg.statemem.stafflight.Transform:SetPosition(nbqmx.Transform:GetWorldPosition())nbqmx.sg.statemem.stafflight:SetUp(nbqmx.sg.statemem.fxcolour,1.2,.33)end),TimeEvent( 13*FRAMES,function(IWQcC)if IWQcC.sg.statemem.castsound then IWQcC.SoundEmitter:PlaySound(IWQcC.sg.statemem.castsound)end end),TimeEvent(53*FRAMES,function(cvRh)cvRh.sg.statemem.stafffx=nil;cvRh.sg.statemem.stafflight=nil;if cvRh.sg.statemem.spellfn then cvRh.sg.statemem.spellfn(cvRh)end end),TimeEvent(70*FRAMES,function(W9yaJm)W9yaJm.sg:RemoveStateTag("busy")if W9yaJm.components.playercontroller~=nil then W9yaJm.components.playercontroller:Enable(true)end end)},events={EventHandler("animqueueover",function(oJ1ec)if oJ1ec.AnimState:AnimDone()then oJ1ec.sg:GoToState("idle")end end)},onexit=function(L)if L.components.playercontroller~=nil then L.components.playercontroller:Enable(true)end;if L.sg.statemem.stafffx~=nil and L.sg.statemem.stafffx:IsValid()then L.sg.statemem.stafffx:Remove()end if L.sg.statemem.stafflight~=nil and L.sg.statemem.stafflight:IsValid()then L.sg.statemem.stafflight:Remove()end end})local function E(MMNWLk)if MMNWLk._parent~=nil then local x6Ni=MMNWLk._old_xiumianpercent;local Q2waXkyp=MMNWLk.current_xiumian:value()/MMNWLk.max_xiumian:value()local EG72={oldpercent=x6Ni,newpercent=Q2waXkyp,delta=MMNWLk.current_xiumian:value()- (x6Ni*MMNWLk.max_xiumian:value())}MMNWLk._old_xiumianpercent=Q2waXkyp;MMNWLk._parent:PushEvent("_xiumiandelta",EG72)end end;AddPrefabPostInit("player_classified",function(mlTMZ)mlTMZ.max_xiumian=net_ushortint(mlTMZ.GUID,"current_xiumian.max")mlTMZ.current_xiumian=net_ushortint(mlTMZ.GUID,"current_xiumian.current","current_xiumiandirty")if not TheWorld.ismastersim then mlTMZ._old_xiumianpercent=mlTMZ.max_xiumian:value()>0 and mlTMZ.current_xiumian:value()/mlTMZ.max_xiumian:value()or 0;mlTMZ:ListenForEvent("current_xiumiandirty",E)end end)local KMw7_i1s=require("widgets/xiumian")local function CQi(q)if q.owner and q.owner.prefab=="wormwood"then if q.xiumian==nil then q.xiumian=q:AddChild(KMw7_i1s(q.owner))end;q.owner:DoTaskInTime(0.3,function()local yK,rHLz2GD,BlW0RhJA=q.stomach:GetPosition():Get()local Uy,n,TKu=q.brain:GetPosition():Get()local M6kL,M7o_,dk2X7J7=q.heart:GetPosition():Get()if n==rHLz2GD or n==M7o_ then q.xiumian:SetPosition(q.stomach:GetPosition()+Vector3(yK-Uy,0,0))else q.xiumian:SetPosition(q.stomach:GetPosition()+Vector3(yK-M6kL,0,0))end end)local xb6=q.SetGhostMode;function q:SetGhostMode(jv,...)xb6(q,jv,...)if jv then if q.xiumian~=nil then q.xiumian:Hide()end else if q.xiumian~=nil then q.xiumian:Show()end end end end end;AddClassPostConstruct("widgets/statusdisplays",CQi)